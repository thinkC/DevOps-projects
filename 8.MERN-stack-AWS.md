# MERN Stack Implementation of Todolist on AWS

## Step 1 - Configuring Backend
First we login to our ubuntu server using SSH. Before proceeding , create a new Ubuntu VM on AWS and allow SSH port 22 and HTTP port 80 on the security group.

```bash
ssh -i C:\Users\Babatunde\...\...\mysingular-EC2.pem ubuntu@18.214.87.52
```

Netw we update and upgrade ubuntu

```bash
sudo apt update
sudo apt upgrade
```

Next, we get the location of Node.js software on ubuntu repository

```bash
curl -sL https://deb.nodesource.com/setup_12.x | sudo -E bash -
```

Next, we install node.js

```bash
sudo apt-get install -y nodejs
```

We then check for the node and npm versions

```bash
node -v
```

output

```bash
v12.22.1
```

```bash
npm -v
```

output
```bash
6.14.12
```

## Todo list Application code setup

We create a folder for our todolist application

```bash
mkdir Todo
```

We change directory to the new Todo folder, we will then initialize it so that a new file called _package.json_ is created. This will contain all our todo app software dependancies.

```bash
cd Todo
```

Type below to create package.json

```bash
npm init
```

output

```bash
package name: (todo)
version: (1.0.0)
description:
entry point: (index.js)
test command:
git repository:
keywords:
author: Tunde Oyewo
license: (ISC)
About to write to /home/ubuntu/Todo/package.json:

{
  "name": "todo",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "Tunde Oyewo",
  "license": "ISC"
}


Is this OK? (yes)
```
Run `ls` command again to confirm the package.json file is created

output
```bash
package.json
```

## Install ExpressJS

Express is a Node.js framework that helps simplifies development, one of the things Express js will do for us is to help define routes for our application based on HTTP methods and URLs.

We start using _Express_ by first installing it.

```bash
npm install express
```

output

```bash
npm notice created a lockfile as package-lock.json. You should commit this file.
npm WARN todo@1.0.0 No description
npm WARN todo@1.0.0 No repository field.

+ express@4.17.1
added 50 packages from 37 contributors and audited 50 packages in 2.426s
found 0 vulnerabilities
```

Next, we create a file _index.js_

```bash
touch index.js
```
and run `ls` to see created file.

output

```bash
index.js  node_modules  package-lock.json  package.json
```

Next, we install `dotenv` .
```bash
npm install dotenv
```

output

```bash
npm WARN todo@1.0.0 No description
npm WARN todo@1.0.0 No repository field.

+ dotenv@10.0.0
added 1 package and audited 51 packages in 0.8s
found 0 vulnerabilities
```

We then open index.js with the nano editor

```bash
sudo nano index.js
```

Copy the below code to the index.js file. Save with `ctrl + o` and exit with `ctrl + x` .

```javascript
const express = require('express');
require('dotenv').config();

const app = express();

const port = process.env.PORT || 5000;

app.use((req, res, next) => {
res.header("Access-Control-Allow-Origin", "\*");
res.header("Access-Control-Allow-Headers", "Origin, X-Requested-With, Content-Type, Accept");
next();
});

app.use((req, res, next) => {
res.send('Welcome to Express');
});

app.listen(port, () => {
console.log(`Server running on port ${port}`)
});
```
Notice we are using port 5000, our express server will be listenning on this port.

Now we start our server to see if it works.

output

```javascript
ubuntu@ip-172-31-51-29:~/Todo$ node index.js
Server running on port 5000
```

Next we allow port 5000 on our EC2 Ubuntu server


 ![security-group](./img-MERN-ec2/img1.png)

Now, on the browser, we try and access our express app.

```javascript
http://18.214.87.52:5000/
```

  ![security-group](./img-MERN-ec2/img2.png)

  ## Routes

  Our Todo app will be able to perform the following tasks and each task will be associated with these HTTP request method `POST`, `GET`, `DELETE`
  
  * Add a new Todo task
  * View all todo tasks
  * Delete Todo task


  We will create various routes for the different endpoints of our  `todo-app`

We folder _routes_ and _cd_ to it
  ```bash
  mkdir routes
  ```

```bash
cd routes
```

Create file _api.js_

```bash
touch api.js
```

Open the _api.js_ file with nano editor and paste code below

```javascript
const express = require ('express');
const router = express.Router();

router.get('/todos', (req, res, next) => {

});

router.post('/todos', (req, res, next) => {

});

router.delete('/todos/:id', (req, res, next) => {

})

module.exports = router;
```

Save with `ctrl + o` and exit with `ctrl + x` .

## Models

Next we create models to define our database schema. Schema is like a blueprint of our database . We will be using Mongodb ,a No-Sql data for this application.

We will require mongoose to achive this.

Change directory back to Todo folder

```bash 
cd ..
```
un code below to install mongoose
```bash 
npm install mongoose
```

output

```bash
npm WARN todo@1.0.0 No description
npm WARN todo@1.0.0 No repository field.

+ mongoose@5.12.14
added 29 packages from 93 contributors and audited 80 packages in 2.669s

2 packages are looking for funding
  run `npm fund` for details

found 0 vulnerabilities
```

We then creeate a new folder called _models_

```bash
mkdir models
```

Cd to _models_ and create a file called _todo.js_ .

```bash
touch todo.js
```
Open the _todo.js_ file with nano editor and paste in the code below. Here we are creating our todo schema. The text will be a string and the text field will be required.
```bash
sudo nano todo.js
```
```javascript
const mongoose = require('mongoose');
const Schema = mongoose.Schema;

//create schema for todo
const TodoSchema = new Schema({
action: {
type: String,
required: [true, 'The todo text field is required']
}
})

//create model for todo
const Todo = mongoose.model('todo', TodoSchema);

module.exports = Todo;
```

Save with `ctrl + o` and exit with `ctrl + x` .

